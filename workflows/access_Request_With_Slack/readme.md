
# Modernize your access request management with Okta and Slack

` `TOC \h \u \z [**Modernize your access request management with Okta and Slack](#_k03svteqy4mi)**	 PAGEREF \_k03svteqy4mi \h **1**

[Overview](#_tjnvz3iziazz)	 PAGEREF \_tjnvz3iziazz \h 1

[Overview of the access request flow](#_5zpvu8l0rlxy)	 PAGEREF \_5zpvu8l0rlxy \h 1

[Pre-requirements](#_8rc7kj95if6)	 PAGEREF \_8rc7kj95if6 \h 2

[Package Flows](#_qblgjtrbl6rr)	 PAGEREF \_qblgjtrbl6rr \h 2

[Package Tables](#_j9d669toycbg)	 PAGEREF \_j9d669toycbg \h 4

[Step-by-step instructions](#_5htg0j6ia29b)	 PAGEREF \_5htg0j6ia29b \h 4

[Importing the FLOWPACK](#_5y5wabfg2ke7)	 PAGEREF \_5y5wabfg2ke7 \h 4

[Create the custom Slack application](#_nwjp2phhm6gv)	 PAGEREF \_nwjp2phhm6gv \h 8

[Configuring Okta Workflows](#_1kb5dmp839wd)	 PAGEREF \_1kb5dmp839wd \h 19

[Testing this Flow](#_dkym6a9b4vvw)	 PAGEREF \_dkym6a9b4vvw \h 34

[Limitations & Known Issues](#_lrdevkyvp5jb)	 PAGEREF \_lrdevkyvp5jb \h 39

[Additional Resources](#_ff0lcaf8nesu)	 PAGEREF \_ff0lcaf8nesu \h 39


## Overview
Deliver a modern access request experience using the Okta Platform, with a no-code approach and no customizations to the Okta product:

- The solution will use Slack as the user interface;
- Provide application selection and a justification form;
- Deliver at one level of approval, with the user manager as the approver;
- Store the requests and the approval decision.

Using Okta Workflows and Slack we can deliver a modern access request experience using your collaboration tool. The extensibility capabilities of Okta Workflows enables IT Administrators to design and deploy the process that best suits their organization’s requirements.

This document assumes a basic understanding of Okta Workflows terminology, components, and UI.
### Overview of the access request flow
This implementation of the use case will use Slack as the collaboration tool and interface to deliver a modern end-user experience during the request lifecycle. The solution uses flows that are executed at Okta Workflows and will interact with the Okta Identity Cloud tenant as well as a custom Slack application that will allow your Slack workspace to interact with your Okta Organization. To properly run and track the requests, the solution will leverage sub-flows, internal tables, the Okta connector, Okta API, the out-of-the-box Slack connector, and Slack API. 
#### Pre-requirements
- Slack Workspace
- Okta tenant with Workflows enabled.
- The FLOWPACK, link provided in this document.
#### Package Flows
This access request use case is implemented using a total of 13 flows, the flows follow a naming convention to help identify their purpose but also, to allow extensibility. Currently, this use case only focuses on application requests but it is possible to extend this example to cover additional requirements, for example, integration with ASA, allowing the IT team to request access to servers.


![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.001.png)

The **Request.01** flow is the “router” and will orchestrate the exchange between Slack and Workflows.

The **Request.Approval** flows are responsible for determining what happens when the request is either approved or rejected. These can be extended to accommodate additional resources like servers or groups.

The **Request.Apps** flows are responsible for handling all the interactions during an application request process, the different modals that are displayed to the user, the notifications etc.

The **Util** flows controls the JWT token used to control each request, and the flows responsible for signing and verifying the signature of every request.
#### Package Tables
The solution uses two tables to preserve data that is used and generated by the solution. The tables are also used to control the data flow and configuration options.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.002.png)

The **Requests** table is used to store the actual requests that are made using the solution. During a new request a new **Token** and **Key** are generated to ensure that the request is unique and once the request lifecycle is complete, it cannot be reused.

The **Variables** table is used to store specific configuration information of the solution.
## Step-by-step instructions
### Importing the FLOWPACK
1. At the Templates tab, search for the template and Add it to your Workflows tenant.
1. Once the upload is complete, you will see the following list.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.003.png)

1. We need to configure the “**Request.00.SlackBot.Acknowledgement**” to be a public end-point API. To do that, click the cog ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.004.png) at the end of the flow.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.005.png)

1. Click ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.006.png).

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.007.png)

1. Confirm that the API Endpoint Settings is **exposed as Webhook** and **copy** the **Invoke URL**, we will use this information to setup the Slack App.
1. Close the window.
### Create the custom Slack application
1. Log in to your Slack workspace, and navigate to <https://api.slack.com/apps/>.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.008.png)

Note if you already have any applications your screen will be different.

1. Click the “Create an App” button.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.009.png)

1. Provide a name to your application “Okta Requests”, select the development Slack workspace, and select “Create App”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.010.png)

1. Once the application is created, we will be able to configure the app to interact with Okta Workflows.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.011.png)

1. From the Basic Information screen, click “Incoming Webhooks”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.012.png)

1. Activate Incoming Webhooks, this will allow Okta Workflows to communicate with the application.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.013.png)

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.014.png)


1. From the left menu, select “Interactivity & Shortcuts”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.015.png)

1. Similar to Incoming Webhooks, we need to activate the functionality.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.016.png)

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.017.png)

1. We need to inform a Request URL, this is the **Invoke URL** that we copied for flow **Request.00.SlackBot.Acknowledge**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.018.png)

1. Next, we add a shortcut to our app, this way users can quickly invoke the app from Slack. Click “Create New Shortcut”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.019.png)

1. Select “Global” and click “Next”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.020.png)

1. Fill in the details with the following information, name “**Request access**”, short description “**Request access to applications.**”, and callback ID “**request\_access**”. Click “Create” to create the shortcut.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.021.png)

1. Now save the changes, by clicking “Save Changes” at the bottom of the screen.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.022.png)

1. From the left-menu click “OAuth & Permissions”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.023.png)

1. We need to inform the scopes our application requires in order to interact with Slack. Scroll down to the Scopes section of the OAuth & Permissions page.
1. Click “Add an OAuth Scope”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.024.png)

1. From the list search and select “**chat:write**”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.025.png)

1. Repeat steps 16 and 17 for the following scopes:
   1. **chat:write.public**
   1. **links:write**
   1. **users:read**
   1. **users:read.email**

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.026.png)

1. Below Bot Token Scopes, we have User Token Scopes. We need to add two additional scopes that are part of user token scopes.
1. Click “Add an OAuth Scope” (at the User Token Scopes section).

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.027.png)

1. From the list, search and select “**chat:write**”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.028.png)

1. Repeat steps 20 and 21, to add “**links:write**”.
1. At the end, you should have a similar list like the image below.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.029.png)

1. Now we need to install our app to the Workspace. We do that by scrolling to the top of the page and clicking “Install to Workspace”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.030.png)

1. Review the information and select a channel for the Okta Requests app to post to. For the purposes of this demo, I’m using a private channel that only the “compliance and audit” team have access to, this way every time a request is either approved or rejected, the team receives a notification. Once you are done, click “Allow”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.031.png)

To use a private channel, an Slack Workspace administrator must invite the app to join the channel, otherwise the app won’t be able to send messages.

1. Once the installation is complete, you will have access to the OAuth Tokens. For the purpose of this demo, we will be using the “Bot User OAuth Token”, so go ahead and copy it for later use (you can always come back to this screen to copy the token).

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.032.png)

1. As I mentioned previously, I’m using a private channel to receive the notifications, so I’ll go ahead and invite the app to the channel.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.033.png)![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.034.png)

### Configuring Okta Workflows
1. Log in to your Okta tenant administration console and open “Workflows console”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.035.png)

1. Click “Connections”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.036.png)

1. Click ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.037.png).

1. Select HTTP from the list.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.038.png)

1. For the new connection use “**Slack - Okta Requests**” as the connection nickname and for the auth type select “**Custom**”. Here we will use the bot user OAuth token that we copied on [Create the custom Slack application](#_nwjp2phhm6gv) step 26.
   1. Header Name = Authorization
   1. Header Value = Bearer <Bot\_User\_OAuth\_Token>
      1. *There is a space between the bearer and the actual token.*

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.039.png)

1. Once you are done, click “Create”.
1. If you already have an Okta connection you can skip to step 17, if not keep following along.
1. To create an Okta connection we need some information from the “**Okta Workflows OAuth**” application, log in to your Okta administration console, navigate to applications.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.040.png)

1. Select “**Okta Workflows OAuth**” from the list, and select “Sign On”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.041.png)

1. Copy the client ID and client secret, we will use this information to create our Okta connection at Workflows.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.042.png)

1. Back into Okta Workflows, click “Connections”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.036.png)

1. We need to create a new Okta connection, click ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.037.png).

1. Select Okta from the list.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.043.png)

1. For the new connection use “**Okta**” as the connection nickname, the domain will be the tenant you are using, the client ID and client secret is the information we copied from the “**Okta Workflows OAuth**” application.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.044.png)

1. Click “Create”.
1. Now we need to update all of the connections that are used by the flow individually. To do that, click “Home”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.045.png)


1. For the next steps, we need to associate the new “**Slack - Okta Requests**” connection with HTTP cards and make sure the Okta cards have an Okta connection. The following flows need to be updated:
   1. **Request.01. SlackBot.Router** - HTTP
   1. **Request.Approval.02. SlackBot.RejectedTrigger** - Okta
   1. **Request.Apps.01. SlackBot.Form** - HTTP and Okta
   1. **Request.Apps.02.01. SlackBot.SubmitRequestToManager** - HTTP and Okta
   1. **Request.Apps.02.02. SlackBot.Approved** - Okta
   1. **Request.Apps.02.03. SlackBot.Approved.Beneficiary.Message** - HTTP and Okta
1. Select the folder where you imported the FLOWPACK.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.046.png)

1. Select **Request.01. SlackBot.Router**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.047.png)

1. Scroll to the right until you see the “If/ElseIf” card.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.048.png)

1. From the “Edit Conditions” drop down, select the first “if callback\_id == “request…””.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.048.png)


1. If any HTTP connection was available, all HTTP cards will automatically be associated with that connection once you import the FLOWPACK. In this case, you need to change the connection and select “**Change All**” when prompted.![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.049.png)
   If not, you will see a ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.050.png) at the HTTP Card, click it.

1. Select the “**Slack - Okta Requests**”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.051.png)

1. Now the “HTTP Post” card has a connection to your Slack App.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.052.png)

1. Save your flow and go back to the flow list. (If prompted for a new name/description just click save to continue).

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.053.png)


1. Select **Request.Approval.02. SlackBot.RejectedTrigger**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.054.png)

1. Similar to how we did before, click the ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.050.png) to select our Okta connection. Click the Okta connection and save.





1. This flow also has HTTP cards that need the HTTP connection to Slack that we created. Scroll to the right and update all HTTP cards with the “**Slack - Okta Requests**” connection, there are a total of 2 cards in this flow. Just repeat the same steps as before, click the ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.050.png) and select a new connection. If prompted to change other connections, click “**Change All**”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.049.png)

1. Click Save and if prompted with the following message, just click Save to continue.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.055.png)

1. Select **Request.Apps.01. SlackBot.Form**. Update the Okta card and HTTP card as we did previously. Click ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.050.png) and if prompted to change other connections, click “**Change All**”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.049.png)

1. Click Save and if prompted with the following message, just click save to continue.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.056.png)

1. Go back to “Home”, and select **Request.Apps.02.01. SlackBot.SubmitRequestToManager**. Update the Okta card and HTTP card as we did previously. Click Save to record the changes, if prompted just click Save again.
1. Go back to “Home”, and select **Request.Apps.02.02. SlackBot.Approved**. Update the Okta card as we did previously. You might encounter an error with the “Okta Assign User to Application for SSO And Provisioning” card after the connection is defined.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.057.png)

1. If your card is similar to the card above, we need to re-select the options for this card before proceeding. Click![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.058.png).

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.059.png)

1. From the drop down, select “ -- Enter Application ID --”, and click Save.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.060.png)

1. This will solve the message, and your card will be correct. Click Save at the bottom of the card.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.061.png)

1. Click Save, and as before if prompted click Save again.
1. Go back to “Home”, and select **Request.Apps.02.03. SlackBot.Approved.Beneficiary.Message.** Update the Okta card and HTTP card as we did previously. Click Save to record the changes, if prompted just click Save again.
1. Go back to “Home”.
1. We need to update the “**Variables**” table. Click on the “**Tables (2)**” to change from the flow view to the tables view.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.062.png)

1. The flow uses two tables: **Variables** and **Requests**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.063.png)

1. Select the “**Variables**” table. We need to update the “Approval Channel”, “Audit Channel”, and “Slack Signing Secret”.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.064.png)

1. The **Approval Channel** and **Audit Channel**, are used to notify particular channels of the outcome of each request. This could be useful for an audit or compliance team to track what is happening in the organization, these can be any channel you want.
   1. *Note if you are using a private channel, the application needs to be invited to the channel as you would any other user. To do this, just open the channel and type a “/invite @<your\_application>”.*
1. The **Slack Signing Secret** is copied from your Slack Application. Go to <https://api.slack.com/> and select your application. From the basic information section, copy the **Signing Secret**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.065.png)

1. Paste the secret into the **Slack Signing Secret** column.
1. Once you are done, your table should look like this (with your own information).

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.066.png)

1. Click **Home** to go back to the tables view, and select **Flows (14)**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.067.png)

1. You are ready to activate all flows and perform your first test.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.068.png)
## Testing this Flow
1. The solution uses two attributes from the user profile, **ManagerId** and **Manager**.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.069.png)

1. Log in to your Okta Administration Console, and update both attributes with the manager information. The **ManagerId** corresponds to the email address at Okta and Slack.
1. For this test, I have two users that have access to my Slack Workspace, and one of the users is represented as a manager.
1. The two users used are **Robert Acosta**, and **Adele Vance**. Robert is Adele’s manager and will be responsible for approving the requests.
1. With this requirement in place we updated Adele’s profile, with the following information.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.070.png)

1. Log in to your Slack Workspace.
1. As Adele, from any chat window type /Okta, this will bring up the shortcut that we defined in our Slack App.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.071.png)

1. Hit return/enter or click the **Request access with Okta Requests**.
1. This will bring up the Okta Requests **modal** screen, from here you can request access to applications by clicking the ![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.072.png) button.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.073.png)

1. Select any application you want to request from the drop down.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.074.png)

1. Provide a justification for your request.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.075.png)

1. Click “Submit” to submit your request.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.076.png)

1. After submitting your request, the flow will submit the approval request to the manager specified at the user’s profile.
1. Log in to Slack Workspace as the manager, and the **Okta Requests** bot will have a new message.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.077.png)

1. The manager can go ahead and approve the request. A new browser tab will appear with confirmation that the request was approved.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.078.png)

1. Back to Adele’s Slack, she received a confirmation that the request was approved and she can now access the application.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.079.png)

1. Remember the **Approval Channel**, and **Audit Channel** that we configured at the **Variables** table? The flow will also post a message regarding the request at that particular channel.

![](Aspose.Words.d77f8f4a-dd3a-4e66-88e8-b41f17bc769f.080.png)

## Limitations & Known Issues
- Due to Slack’s API limitations, if the flow does not respond within 3 seconds some submits may fail;
- No error handling is included in the flows, in case some Slack API fails or other errors are raised.
- Keep in mind the Okta Workflows System Limits <https://help.okta.com/en/prod/Content/Topics/Workflows/workflows-system-limits.htm>

## Additional Resources
[Tutorial: Basic Notifications Flow](https://learn.workflows.okta.com/tutorials/notifications-walkthrough/)

[Tutorial: Make API requests, part 1](https://help.okta.com/en/prod/Content/Topics/Workflows/Tutorials/unauthenticatedapi-walkthrough/unauthenticatedapi-walkthrough.htm)

[Tutorial: Make API requests, part 2](https://help.okta.com/en/prod/Content/Topics/Workflows/Tutorials/addbasicapi-walkthrough/addbasicapi-walkthrough.htm)

[Tutorial: Make API requests, part 3](https://help.okta.com/en/prod/Content/Topics/Workflows/Tutorials/processjson-walkthrough/processjson-walkthrough.htm)

